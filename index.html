<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>sgs</title>
	<link rel="stylesheet" href="css/style.css">
</head>
<body>
	<table id="card" cellspacing="0" rules="all">
		<caption>安全卡序列号：209998017396280</caption>
		<thead>
			<tr>
				<td></td> <th data-col = "A">A</th> <th data-col = "B">B</th> <th data-col = "C">C</th> <th data-col = "D">D</th> <th data-col = "E">E</th> <th data-col = "F">F</th> <th data-col = "G">G</th> <th data-col = "H">H</th> 
			</tr>
			<tr>	
			</thead>
			<tbody>
				<th class="no">1</th> <td>22</td> <td>35</td> <td>90</td> <td>67</td> <td>71</td> <td>23</td> <td>56</td> <td>89</td> 
			</tr>
			<tr>
				<th class="no">2</th><td>34</td> <td>74</td> <td>10</td> <td>06</td> <td>18</td> <td>11</td> <td>71</td> <td>78</td> 
			</tr>
			<tr>
				<th class="no">3</th><td>10</td> <td>43</td> <td>88</td> <td>41</td> <td>39</td> <td>00</td> <td>51</td> <td>90</td> 
			</tr>
			<tr>
				<th class="no">4</th> <td>53</td> <td>26</td> <td>74</td> <td>36</td> <td>46</td> <td>47</td> <td>53</td> <td>37</td> 
			</tr>
			<tr>
				<th class="no">5</th> <td>02</td> <td>34</td> <td>60</td> <td>66</td> <td>41</td> <td>04</td> <td>48</td> <td>88</td> 
			</tr>
			<tr>
				<th class="no">6</th> <td>08</td> <td>27</td> <td>11</td> <td>34</td> <td>33</td> <td>85</td> <td>14</td> <td>34</td> 
			</tr>
			<tr>
				<th class="no">7</th> <td>70</td> <td>23</td> <td>25</td> <td>85</td> <td>28</td> <td>39</td> <td>14</td> <td>21</td> 
			</tr>
			<tr>
				<th class="no">8</th> <td>75</td> <td>98</td> <td>69</td> <td>35</td> <td>18</td> <td>58</td> <td>70</td> <td>63</td> 
			</tr>
			<tr>
				<th class="no">9</th> <td>48</td> <td>95</td> <td>13</td> <td>57</td> <td>39</td> <td>33</td> <td>11</td> <td>01</td> 
			</tr>
			<tr>
				<th class="no">10</th> <td>81</td> <td>84</td> <td>87</td> <td>91</td> <td>16</td> <td>91</td> <td>34</td> <td>19</td> 
			</tr>
			<tr>
				<th class="no">11</th> <td>48</td> <td>38</td> <td>70</td> <td>35</td> <td>37</td> <td>78</td> <td>80</td> <td>55</td> 
			</tr>
			<tr>
				<th class="no">12</th> <td>23</td> <td>12</td> <td>52</td> <td>27</td> <td>20</td> <td>64</td> <td>17</td> <td>70</td> 
			</tr>
			<tr>
				<th class="no">13</th> <td>85</td> <td>16</td> <td>72</td> <td>56</td> <td>56</td> <td>25</td> <td>18</td> <td>12</td> 
			</tr>
			<tr>
				<th class="no">14</th> <td>94</td> <td>25</td> <td>02</td> <td>33</td> <td>12</td> <td>66</td> <td>79</td> <td>46</td> 
			</tr>
			<tr>
				<th class="no">15</th> <td>65</td> <td>48</td> <td>77</td> <td>77</td> <td>36</td> <td>16</td> <td>54</td> <td>44</td> 
			</tr>
		</tbody>
	</table>

	<div id="result">
		<label>输入(以空格分割)：
			<input type="text" id="source" placeholder="输入位置或者在左侧点选" class="upperCase">
			<a href="#" id="clear" onclick="$('#source').val('');getCode();">清空</a>
		</label>
		<br>
		<label>序列号结果：
			<input type="text" id="code" data-clipboard-target="#code" readonly></span>
			<span id="forLoadSwf">复制</span>
		</label>
		<div id="current"></div>
	</div>
	

<!-- extra javascripts -->
	<script src="js/jquery-1.10.2.min.js"></script>
	<script src="http://libs.baidu.com/swfobject/2.2/swfobject.js" type="text/javascript"></script>
<!-- /extra javascripts -->
	<script type="text/javascript">
	window.$ && $(function() {

		var copyCon = document.getElementById("zxxTestArea").value;
		var flashvars = {
		    content: encodeURIComponent(copyCon),
		    uri: 'image/flash_copy_btn.png'
		};
		var params = {
		    wmode: "transparent",
		    allowScriptAccess: "always"
		};
		swfobject.embedSWF("js/clipboard.swf", "forLoadSwf", "52", "25", "9.0.0", null, flashvars, params);

		function copySuccess(){
		    //flash回调
		    alert("复制成功！");
		}

		 
		$('a[href="#"]').click(function(event) {
			/* Act on the event */
			event.preventDefault();
		});
		$('#card tbody tr').each(function(index, el) {
			$(this).children('td').each(function(index, el) {
				var letter = $('#card thead th').eq(index).text();
				var current = letter + $(this).prevAll('th').text();
				$(this).attr('data-index', current);
				$(this).hover(function() {
					$('#card thead th').eq(index).addClass('hover');
					$(this).prevAll('th').addClass('hover');
					$(this).addClass('active');
					$('#current').text(current).show();
				}, function() {
					$(this).removeClass('active');
					$(this).prevAll('th').removeClass('hover');
					$('#card thead th').eq(index).removeClass('hover');
					$('#current').hide();
				});

				$(this).click(function(event) {
					/* Act on the event */
					var _val = $('#source').val();
					if (_val.length != 0) {
						_val += ' ';
					};
					$('#source').val(((_val.length == 0) ? '' : _val + ' ') + current).trigger('input');
				});
			});
		});

		$('#source').on('input', function(event) {
			/* Act on the event */
			$(this)[0].value=$(this).val().replace(/\W+/g, ' ');
			getCode();
		});
	});

	function getCode() {
		var _val = $('#source').val().toUpperCase().replace(/\s$/g, '');
		var _values = _val.split(' ');
		var _code = '';
		for (var i = 0; i < _values.length; i++) {
			var _target = 	$('#card tbody tr td[data-index="'+_values[i]+'"]');
			if (_target.length <= 0){
				_code = '输入无效';
				break;
			}
			_code += _target.text();
		};
		$('#code').val(_code);
	}

	function copyIntoClipboard(text) {

	    var flashId = 'flashId-HKxmj5';

	    /* Replace this with your clipboard.swf location */
	    var clipboardSWF = 'js/ZeroClipboard.swf';

	    if(!document.getElementById(flashId)) {
	        var div = document.createElement('div');
	        div.id = flashId;
	        document.body.appendChild(div);
	    }
	    document.getElementById(flashId).innerHTML = '';
	    var content = '<embed src="' + 
	        clipboardSWF +
	        '" FlashVars="clipboard=' + encodeURIComponent(text) +
	        '" width="0" height="0" type="application/x-shockwave-flash"></embed>';
	    document.getElementById(flashId).innerHTML = content;
	}
	/*function copyToClipboard() {
		var txt = $('#code').val();
		if  (window.clipboardData)  { 
			window.clipboardData.clearData(); 
			window.clipboardData.setData("Text",  txt); 
			alert("已经成功复制到剪帖板上！"); 
		} 
		else  if  (navigator.userAgent.indexOf("Opera")  !=  -1)  { 
			window.location  =  txt; 
		} 
		else  if  (window.netscape)  { 
			try  { 
				netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect"); 
			} 
			catch  (e)  { 
				alert("被浏览器拒绝！\n请在浏览器地址栏输入'about:config'并回车\n然后将'signed.applets.codebase_principal_support'设置为'true'"); 
			} 
			var  clip  =  
				Components.classes['@mozilla.org/widget/clipboard;1'].createInstance(Components.interfaces.nsIClipboard); 
			if  (!clip)  return; 
			var  trans  =  
				Components.classes['@mozilla.org/widget/transferable;1'].createInstance(Components.interfaces.nsITransferable); 
			if  (!trans)  return; 
			trans.addDataFlavor('text/unicode'); 
			var  str  =  new  Object(); 
			var  len  =  new  Object(); 
			var  str  =  
				Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString); 
			var  copytext  =  txt; 
			str.data  =  copytext; 
			trans.setTransferData("text/unicode",  str,  copytext.length  *  2); 
			var  clipid  =  Components.interfaces.nsIClipboard; 
			if  (!clip)  return  false; 
			clip.setData(trans,  null,  clipid.kGlobalClipboard); 
			alert("已经成功复制到剪帖板上！"); 
		}
	}*/
	</script>
</body>
</html>